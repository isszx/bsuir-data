<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0048)http://www.citforum.ru/internet/xml2/part1.shtml -->
<HTML><HEAD><TITLE>Язык XML - практическое введение. Часть 2</TITLE>
</HEAD>
<body background="../fon.gif">
<p><div align="center"><b>Язык XML - практическое введение. Часть 2</b></div></p><font size="-1">

<P align=justify><I>XML (Extensible Markup Language) - это новый 
SGML-производный язык разметки документов, позволяющий структурировать 
информацию разного типа, используя для этого произвольный набор инструкций. 
Разработчиков Интернет приложений, пытающихся на практике использовать новую 
технологию, могут заинтересовать конкретные вопросы, связанные с проблемами 
создания, обработки XML-документов, их отображения на стороне клиента. В этой 
статье дается краткое представление о том, что представляет собой и для чего 
нужен XML-документ и на практических примерах иллюстрируются некоторые простые, 
но пока, к сожалению, мало описанные механизмы его обработки.</I></P><A 
name=p1></A>
<P align=justify>&nbsp;&nbsp;&nbsp;<B>Что такое XML</B> 
<P align=justify>&nbsp;&nbsp;&nbsp;Сегодня XML может использоваться в любых 
приложениях, которым нужна структурированная информация - от сложных 
геоинформационных систем, с гигантскими объемами передаваемой информации до 
обычных "однокомпьютерных" программ, использующих этот язык для описания 
служебной информации. При внимательном взгляде на окружающий нас информационный 
мир можно выделить множество задач, связанных с созданием и обработкой 
структурированной информации, для решения которых может использоваться XML: 
<UL>
  <LI>В первую очередь, эта технология может оказаться полезной для 
  разработчиков сложных информационных систем, с большим количеством приложений, 
  связанных потоками информации самой различной структурой. В этом случае XML - 
  документы выполняют роль универсального формата для обмена информацией между 
  отдельными компонентами большой программы. 
  <LI>XML является базовым стандартом для нового языка описания ресурсов, RDF, 
  позволяющего упростить многие проблемы в Web, связанные с поиском нужной 
  информации, обеспечением контроля за содержимым сетевых ресурсов, создания 
  электронных библиотек и т.д. 
  <LI>Язык XML позволяет описывать данные произвольного типа и используется для 
  представления специализированной информации, например химических, 
  математических, физических формул, медицинских рецептов, нотных записей, и 
  т.д. Это означает, что XML может служить мощным дополнением к HTML для 
  распространения в Web "нестандартной" информации. Возможно, в самом ближайшем 
  будущем XML полностью заменит собой HTML, по крайней мере, первые попытки 
  интеграции этих двух языков уже делаются (спецификация <A 
  href="http://www.w3.org/TR/xhtml-modularization">XHTML</A>). 
  <LI>XML-документы могут использоваться в качестве промежуточного формата 
  данных в трехзвенных системах. Обычно схема взаимодействия между серверами 
  приложений и баз данных зависит от конкретной СУБД и диалекта SQL, 
  используемого для доступа к данным. Если же результаты запроса будут 
  представлены в некотором универсальном текстовом формате, то звено СУБД, как 
  таковое, станет "прозрачным" для приложения. Кроме того, сегодня на 
  рассмотрение W3C предложена спецификация нового языка запросов к базам данных 
  XQL, который в будущем может стать альтернативой SQL. 
  <LI>Информация, содержащаяся в XML-документах, может изменяться, передаваться 
  на машину клиента и обновляться по частям. Разрабатываемые спецификации XLink 
  и Xpointer поволят ссылаться на отдельные элементы документа, c учетом их 
  вложенности и значений атрибутов. 
  <LI>Использование стилевых таблиц (XSL) позволяет обеспечить независимое от 
  конкретного устройства вывода отображение XML- документов. 
  <LI>XML может использоваться в обычных приложениях для хранения и обработки 
  структурированных данных в едином формате. </LI></UL>
<P align=justify>&nbsp;&nbsp;&nbsp;Поверхностное описание языка можно найти в первых двух главах. Напомню лишь в общих словах, что XML-документ 
представляет собой обычный текстовый файл, в котором при помощи специальных 
маркеров создаются элементы данных, последовательность и вложенность которых 
определяет структуру документа и его содержание. Основным достоинством XML 
документов является то, что при относительно простом способе создания и 
обработки (обычный текст может редактироваться любым тестовым процессором и 
обрабатываться стандартными XML анализаторами), они позволяют создавать 
структурированную информацию, которую хорошо "понимают" компьютеры. <A 
name=p2></A>
<P align=justify>&nbsp;&nbsp;&nbsp;<B>Как создать XML документ?</B> 
<P align=justify>&nbsp;&nbsp;&nbsp;Для создания XML документа в простейшем 
случае вам не понадобится ничего кроме обычного текстового редактора (по мнению 
многих Web-дизайнеров, лучший инструмент для создания Web-страниц). Вот пример 
небольшого XML-документа, используемого вместо обычной записной книжки: <PRE>&lt;?xml version="1.0" encoding="koi-8"?&gt;
&lt;notepad&gt;
 &lt;note id="1" date="12/04/99" time="13:40"&gt;
 &lt;subject&gt;Важная деловая встреча&lt;/subject&gt;
 &lt;importance/&gt;
 &lt;text&gt;
 Надо встретиться с &lt;person id="1625"&gt;
 Иваном Ивановичем&lt;/person&gt;, предварительно
 позвонив ему по телефону &lt;tel&gt;123-12-12&lt;/tel&gt; 
 &lt;/text&gt;
 &lt;/note&gt;
 ...
 &lt;note id="2" date="12/04/99" time="13:58"&gt;
 &lt;subject&gt;Позвонить домой&lt;/subject&gt;
 &lt;text&gt;
 &lt;tel&gt;124-13-13&lt;/tel&gt;
 &lt;/text&gt;
 &lt;/note&gt;
&lt;/notepad&gt;
</PRE>
<P align=justify>&nbsp;&nbsp;&nbsp;При создании собственного языка разметки вы 
можете придумывать любые названия элементов, (почти любые, т.к. список 
допустимых символов ограничен и приведен в <A 
href="http://www.w3.org/TR/1998/REC-xml-19980210">спецификации XML</A>), 
соответствующих контексту их использования. В нашем примере приведен лишь один 
из многочисленных способ создания структуры дневника. В этом и заключается 
гибкость и расширяемость XML-производных языков - они создаются разработчиком 
"на лету", согласно его представлениям о структуре документа, и могут затем 
использоваться универсальными программами просмотра наравне с любыми другими 
XML-производными языками, т.к. вся необходимая для синтаксического анализа 
информация заключена внутри документа. 
<P align=justify>&nbsp;&nbsp;&nbsp;Создавая новый формат, необходимо учитывать 
тот факт, что документов, "написанных на XML", не может быть в принципе - в 
любом случае авторы документа для его разметки используют основанный на 
стандарте XML (т.н. XML-производный) язык, но не сам XML. Поэтому при сохранении 
созданного файла можно выбрать для него какое-то подходящее названию расширение 
(например, noteML). 
<P align=justify>&nbsp;&nbsp;&nbsp;XML может использоваться вами для создания 
документов какого-то определенного типа и структурой, необходимой для 
конкретного приложения. Однако если сфера применения языка оказывается 
достаточно широкой и он начинает представлять интерес для большого числа 
разработчиков, то его спецификация вполне может быть представлена на 
рассмотрение в W3C и после согласования всеми заинтересованными сторонами, 
утверждена консорциумом в качестве официальной рекомендации. 
<P align=justify>&nbsp;&nbsp;&nbsp;Надо заметить, что процесс появления новой 
спецификации очень длителен и сложен. Любой документ, предлагаемый W3C, прежде 
чем стать стандартом проходит несколько этапов. Сначала пожелания и 
рекомендации, поступающие от различных компаний, участвующих в его разработке, 
оформляются в виде принятого к сведению замечания (Note), своеобразного 
протокола о намерениях. Информация, изложенная в таких документах предназначена 
только для обсуждения членами консорциума и никто не дает гарантии того, что эти 
замечания потом станут рекомендацией. 
<P align=justify>&nbsp;&nbsp;&nbsp;Следующей этапом продвижения документа 
является рабочий вариант спецификации, который составляет и изменяет в 
дальнейшем специально созданная рабочая группа (Working Group), в состав которой 
входят представители заинтересовавшихся идеей компаний. Все изменения, вносимые 
в этот документ обязательно публикуются на сервере консорциума www.w3.org и до 
тех пор, пока рабочий вариант не станет рекомендацией, он может служить для 
разработчиков лишь "путеводной звездой", с которой компания может сверять свои 
планы, но не должна использовать при разработке ПО. 
<P align=justify>&nbsp;&nbsp;&nbsp;В том случае, если стороны договорились по 
всем основным вопросам и существенных изменений в документ больше вносится, 
рабочий вариант становится Предложенной Рекомендацией и после голосования 
членами рабочей группы может стать уже Официальной Рекомендаций W3C, что по 
статусу соответствует стандарту в WWW. <A name=p3></A>
<P align=justify>&nbsp;&nbsp;&nbsp;<B>XML-генераторы</B> 
<P align=justify>&nbsp;&nbsp;&nbsp;XML документы могут служить промежуточным 
форматом для передачи информации от одного приложения к другому (например, как 
результат запроса к базе данных), поэтому их содержимое иногда генерируется и 
обрабатывается программами автоматически. Далеко не всегда XML документ нужно 
создавать вручную. 
<P align=justify>&nbsp;&nbsp;&nbsp;Пусть, например, нашей задачей является 
создание формата хранения данных регистрации каких-то происходящих в системе 
событий (log-файла). В простейшем случае можно ограничиться фиксированием 
успешных и ошибочных запросов к нашим ресурсам - в таком документе должна 
присутствовать информация о времени произошедшего события, его результате 
(удача/ошибка), IP адресе источника запроса, URI ресурса и коде результата. 
<P align=justify>&nbsp;&nbsp;&nbsp;Наш XML документ может выглядеть следующим 
образом: <PRE>&lt;?xml version="1.0" encoding="koi-8"?&gt;
 &lt;log&gt;
 &lt;event date=" 27/May/1999:02:32:46 " result="success"&gt;
 &lt;ip-from&gt; 195.151.62.18 &lt;/ip-from&gt;
 &lt;method&gt;GET&lt;/method&gt;
 &lt;url-to&gt; /misc/&lt;/url-to&gt;
 &lt;response&gt;200&lt;/response&gt;
 &lt;/event&gt;
 &lt;event date=" 27/May/1999:02:41:47 "
  result="success"&gt;
 &lt;ip-from&gt; 195.209.248.12 &lt;/ip-from&gt;
 &lt;method&gt;GET&lt;/method&gt;
 &lt;url-to&gt; /soft.htm&lt;/url-to&gt;
 &lt;response&gt;200&lt;/response&gt;
 &lt;/event&gt;
 &lt;/log&gt;
</PRE>
<P align=justify>&nbsp;&nbsp;&nbsp;Структура документа довольно проста - 
корневым в данном случае является элемент log, каждое произошедшее событие 
фиксируется в элементе event и описывается при помощи его атрибутов(date - время 
и result - тип события ) и внутренних элементов (method - метод доступа, ip-from 
- адрес источника, url-to - запрашиваемый ресурс, response - код ответа). 
Генерацией этого документа может заниматься, например, модуль аутентификации 
запросов в систему, а использованием - программа обработки регистрационных 
данных (log viewer). <A name=p4></A>
<P align=justify>&nbsp;&nbsp;&nbsp;<B>Что такое DTD?</B> 
<P align=justify>&nbsp;&nbsp;&nbsp;Итак, мы создали XML документ и убедились, 
что набор используемых при этом тэгов позволяет осуществлять любые манипуляции с 
нашей информацией. В таком случае, для того, чтобы утвердить правила нашего 
нового языка, т.е. список допустимых элементов, их возможное содержимое и 
атрибуты, мы должны создать DTD - определения (на момент написания статьи 
спецификация <A href="http://www.w3.org/TR/xmlschema-1/">схем данных</A> для 
XMLдокументов еще не утверждена и пока DTD являются единственным стандартным 
способом описания грамматики). 
<P align=justify>&nbsp;&nbsp;&nbsp;Более подробно о DTD можно прочитать в <A href="part4.html">этой</A> главе, здесь приведy лишь небольшой пример для нашего XML-документа: <PRE>&lt;?xml encoding="koi8-r"?&gt;
 &lt;!ELEMENT log (event)+&gt;
&lt;!ELEMENT event (ip-from,method,uri-to,result)&gt;
&lt;!ELEMENT method (#PCDATA)&gt;
&lt;!ELEMENT ip-from (#PCDATA)&gt;
&lt;!ELEMENT url-to (#PCDATA)&gt;
&lt;!ELEMENT response (#PCDATA)&gt;
&lt;!ATTLIST event
  result CDATA #IMPLIED
  date CDATA #IMPLIED&gt;
</PRE>
<P align=justify>&nbsp;&nbsp;&nbsp;Сохраните этот файл под именем log.dtd и 
включите в XML-документ новую строчку: 
<P align=justify>&nbsp;&nbsp;&nbsp; <I>&lt;!--DOCTYPE log SYSTEM 
"log.dtd"--&gt;</I> 
<P align=justify>&nbsp;&nbsp;&nbsp;Теперь верифицирующий XML-анализатор при 
обработке документа будет сверять порядок определения элементов и их атрибутов с 
тем, как это указано у нас в DTD-нотациях и в случае нарушения внутренней 
структуры (которая определяет "семантику" документа) выдавать сообщение об 
ошибке. <A name=p5></A>
<P align=justify>&nbsp;&nbsp;&nbsp;<B>Что такое Namespaces?</B> 
<P align=justify>&nbsp;&nbsp;&nbsp;Как уже упоминалось ранее, вся прелесть 
использования XML заключается в возможности придумывания собственных тэгов, 
названия которых наиболее полно соответствовали бы предназначению. Но фантазия и 
словарный запас людей не безграничны, поэтому нет абсолютно никакой гарантии 
того, что данные вами имена элементов не будут использованы кем-то еще. До тех 
пор, пока в вашем приложении обрабатываются только собственные XML-документы, 
никаких проблем не возникнет. Но вполне возможна ситуация, когда один и тот же 
документ будет содержать информацию для нескольких обработчиков одновременно. В 
этом случае названия некоторых элементов или их атрибутов могут совпасть, что 
вызовет либо ошибку в XML- анализаторе, либо неправильное представление 
документа. Например, в нашем случае, элемент event вполне мог бы быть 
использован для записи других событий и обрабатываться другим приложением. 
<P align=justify>&nbsp;&nbsp;&nbsp;Чтобы исправить эту ситуацию, мы должны 
определить уникальные названия элементов и их атрибутов, "дописывая" к их 
обычным именам некоторый универсальный неповторяющийся префикс. Для этого 
применяется механизм Namespaces (<A 
href="http://www.w3.org/TR/1999/REC-xml-names-19990114/">спецификация</A> 
Namespaces была официально утверждена W3C в январе 1999 года и сегодня является 
частью стандарта XML). Согласно этой спецификации, для определения "области 
действия" тэга ( на самом деле этот термин, широко используемый в обычных языках 
программирования, неприменим в XML, потому что как такового множества, на 
котором могла бы быть построена "область", внутри структурированного XML 
документа нет) необходимо определить уникальный атрибут, описывающий название 
элемента, по которому анализатор документа сможет определить, к какой группе 
имен оно относится (Namespace идентификаторы могут применяться для описания 
уникальных названий как элементов, так и их атрибутов). В нашем последнем 
примере это может быть сделано так: <PRE><P align=justify>&nbsp;&nbsp;&nbsp;&lt;?xml version="1.0" encoding="koi8-r"?&gt;
<P align=justify>&nbsp;&nbsp;&nbsp;&lt;!--DOCTYPE log SYSTEM "log.dtd"--&gt;
<P align=justify>&nbsp;&nbsp;&nbsp;&lt;log xmlns:xlg="www.mrcpk.nstu.ru/xml/ar/4/"&gt;
<P align=justify>&nbsp;&nbsp;&nbsp; &lt;xlg:event xlg:date=" 27/May/1999:02:32:46 " 
xlg:result="success"&gt;
<P align=justify>&nbsp;&nbsp;&nbsp; &lt;ip-from&gt; 195.151.62.18 &lt;/ip-from&gt;
<P align=justify>&nbsp;&nbsp;&nbsp; &lt;method&gt;GET&lt;/method&gt;
<P align=justify>&nbsp;&nbsp;&nbsp; &lt;url-to&gt; /misc/&lt;/url-to&gt;
<P align=justify>&nbsp;&nbsp;&nbsp; &lt;response&gt;200&lt;/response&gt;
<P align=justify>&nbsp;&nbsp;&nbsp;&lt;/event&gt;
<P align=justify>&nbsp;&nbsp;&nbsp; &lt;xlg:event date=" 27/May/1999:02:41:47 "
 result="success"&gt;
<P align=justify>&nbsp;&nbsp;&nbsp; &lt;ip-from&gt; 195.209.248.12 &lt;/ip-from&gt;
<P align=justify>&nbsp;&nbsp;&nbsp; &lt;method&gt;GET&lt;/method&gt;
<P align=justify>&nbsp;&nbsp;&nbsp; &lt;url-to&gt; /soft.htm&lt;/url-to&gt;
<P align=justify>&nbsp;&nbsp;&nbsp; &lt;response&gt;200&lt;/response&gt;
<P align=justify>&nbsp;&nbsp;&nbsp;&lt;/event&gt;
<P align=justify>&nbsp;&nbsp;&nbsp; &lt;/log&gt;
<P align=justify>&nbsp;&nbsp;&nbsp; </P></PRE>
<P align=justify>&nbsp;&nbsp;&nbsp;Уникальность атрибуту имени обеспечивает 
использование в качестве его значения некоторых универсальных идентификаторов 
ресурсов (например, URI или ISBN) . 
<P align=justify>&nbsp;&nbsp;&nbsp;Полную информацию по использованию Namespace 
вы можете найти в <A 
href="http://www.w3.org/TR/1999/REC-xml-names-19990114/">официальной 
спецификации</A> этого стандарта. В дальнейшем, для упрощения примеров, мы будем 
Namespace - описания пропускать. <A name=p6></A>
<P align=justify>&nbsp;&nbsp;&nbsp;<B>Инструментарий</B> 
<P align=justify>&nbsp;&nbsp;&nbsp;Очевидно, что ручной способ создания 
структурированной информации не может применяться для наполнения больших 
информационных узлов. Для этого существуют специальные средства разработки, 
список которых сегодня постоянно пополняется (их обзор будет приведен в одной из 
следующих статей). Одним их самых простых и удобных, на мой взгляд, является 
редактор XML Notepad, получить который можно здесь -<A 
href="http://msdn.microsoft.com/xml/notepad/intro.asp">msdn.microsoft.com/xml/notepad/intro.asp</A>). 
<A name=p7></A>
<P align=justify>&nbsp;&nbsp;&nbsp;<B>Обработка XML-документов</B> 
<P align=justify>&nbsp;&nbsp;&nbsp;Основным сдерживающим фактором в продвижении 
XML технологии в Web на сегодняшний день является отсутствие полной поддержки 
этого формата всеми производителями броузеров - программ, наиболее часто 
используемых на стороне клиента. Выходом из создавшейся ситуации может стать 
вариант, при котором обработкой XML документов занимается серверная сторона 
Используя любой существующий XML-анализатор, можно формировать необходимую 
информацию уже на сервере и посылать клиенту нормальный HTML-документ. Однако 
такой способ, конечно, менее гибок, и позволяет использовать XML технологию лишь 
для хранения структурированной информации, но не для ее динамического изменения 
на стороне клиента. 
<P align=justify>&nbsp;&nbsp;&nbsp;В августе 1997 RFC 2376 были утверждены MIME 
типы для XML-ресурсов: text/xml и application/xml. Поэтому XML документы могут 
передаваться по HTTP и отображаться программой просмотра также, как и обычные 
HTML- страницы. Для этого нужно немного изменить конфигурацию Web-сервера (в 
Apache - добавить в файл mime.types строчку "text/xml xml ddt"), а на стороне 
клиента иметь броузер, поддерживающий стилевые таблицы или JavaScript. Сегодня 
такими броузерами являются Microsoft Internet Explorer 5, первый броузер, 
поддерживающий спецификацию XML 1.0 и стилевые таблицы XSL; броузер Amaya, 
предлагаемый консорциумом специально для тестовых целей (<A 
href="http://www.w3.org/Amaya/User/BinDist.html">http://www.w3.org/Amaya/User/BinDist.html</A>) 
и поддерживающий практически все разрабатываемые стандарты W3C. Поддержка XML 
также планируется в будущих версиях Netscape Navigator. <A name=p8></A>
<P align=justify>&nbsp;&nbsp;&nbsp;<B>Объектная модель документа DOM</B> 
<P align=justify>&nbsp;&nbsp;&nbsp;Одним из самых мощных интерфейсов доступа к 
содержимому XML документов является <A href="http://www.w3.org/DOM/">Document 
Object Model</A> - DOM. 
<P align=justify>&nbsp;&nbsp;&nbsp;Объектная модель XML документов является 
представлением его внутренней структуры в виде совокупности определенных 
объектов. Для удобства эти объекты организуются в некоторую древообразную 
структуру данных - каждый элемент документа может быть отнесен к отдельной 
ветви, а все его содержимое, в виде набора вложенных элементов, комментариев, 
секций CDATA и т.д. представляется в этой структуре поддеревьями. Т.к. в любом 
правильно составленном XML-документе обязательно определен главный элемент, то 
все содержимое можно рассматривать как поддеревья этого основного элемента, 
называемого в таком случае корнем дерева документа. Для следующего фрагмента XML 
документа: <PRE>&lt;tree-node&gt;
  &lt;node-level1&gt;
    &lt;node-level2/&gt;
    &lt;node-level2&gt;text&lt;/node-level2&gt;
    &lt;node-level2/&gt;
  &lt;/node-level1&gt;
&lt;node-level1&gt;
   &lt;node-level2&gt;text&lt;/node-level2&gt;
&lt;node-level1&gt;
    &lt;node-level2/&gt;
    &lt;node-level2&gt;&lt;node-level3/&gt;&lt;/node-level2&gt;
&lt;/node-level1&gt;
&lt;/tree-node&gt;
</PRE>
<P align=justify>дерево элементов выглядит так:</P>
<CENTER><IMG alt=pict1 src="pict1.gif"> 
<P align=center>&nbsp;&nbsp;&nbsp;<B>Рис.1</B>Дерево элементов</P></CENTER>
<P align=justify>&nbsp;&nbsp;&nbsp;Объектное представление структуры документа 
не является чем-то новым для разработчиков. Для доступа к содержимому HTML 
страницы в сценариях давно используется объектно-ориентированный подход, - 
доступные для Java Script или VBScript элементы HTML документа могли 
создаваться, модифицироваться и просматриваться при помощи соответствующих 
объектов. Но их список и набор методов постоянно изменяется и зависит от типа 
броузера и версии языка. Для того, чтобы обеспечить независимый от конкретного 
языка программирования и типа документа интерфейс доступа к содержимому 
структурированного документа в рамках W3 консорциума была разработана и 
официально утверждена спецификация объектной модели DOM Level 1. 
<P align=justify>&nbsp;&nbsp;&nbsp;DOM - это спецификация универсального 
платформо- и программно-независимого доступа к содержимому документов и является 
просто своеобразным API для их обработчиков. DOM является стандартным способом 
построения объектной модели любого HTML или XML документа, при помощи которой 
можно производить поиск нужных фрагментов, создавать, удалять и модифицировать 
его элементы. 
<P align=justify>&nbsp;&nbsp;&nbsp;Для описания интерфейсов доступа к 
содержимому XML документов в спецификации DOM применяется платформонезависимый 
язык IDL и для использования их необходимо "перевести" на какой-то конкретный 
язык программирования. Однако этим занимаются создатели самих анализаторов, нам 
можно ничего не знать о способе реализации интерфейсов - с точки зрения 
разработчиков прикладных программ DOM выглядит как набор объектов с 
определенными методами и свойствами. В следующем разделе мы вкратце рассмотрим 
объектную модель Microsoft Internet Explorer 5, доступную из Java Script и 
VBScript сценариев. 
<CENTER>
<P><FONT size=-1><A 
href="index.html">Содержание</A> | <A 
href="part22.html">Вперед</A> 

</FONT></CENTER>
<P>&nbsp; <!--end-->
</BODY></HTML>
